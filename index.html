<!DOCTYPE html>
<html>
<head>
<title>Print C608 TCS</title>
</head>
<body>
<iframe id="dynamic-iframe"
        src="https://script.google.com/macros/s/AKfycbyWroMScMiNL5tuQFbLhW-vLuOuj4NtS8NRpau2fahZy7nnIuyC6ClAGQncG_mBfwTz/exec"
        width="100%"
        height="100%"
        allowfullscreen="true"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; border: none;">
</iframe>

<script>
window.onload = function() {
    // Hàm parse query string thành object
    function getQueryParams() {
        const params = {};
        const queryString = window.location.search.substring(1); // Bỏ dấu ?
        const pairs = queryString.split('&');
        pairs.forEach(pair => {
            const [key, value] = pair.split('=');
            if (key && value) {
                params[decodeURIComponent(key)] = decodeURIComponent(value);
            }
        });
        return params;
    }

    // Lấy parameters
    const queryParams = getQueryParams();
    console.log('Các tham số từ URL:', queryParams); // Để debug, xem trong console

    // Xây dựng URL động cho Apps Script (append tất cả params)
    let appsScriptUrl = 'https://script.google.com/macros/s/AKfycbyWroMScMiNL5tuQFbLhW-vLuOuj4NtS8NRpau2fahZy7nnIuyC6ClAGQncG_mBfwTz/exec';
    if (Object.keys(queryParams).length > 0) {
        const paramString = Object.keys(queryParams)
            .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(queryParams[key])}`)
            .join('&');
        appsScriptUrl += `?${paramString}`;
    }

    // Cập nhật src của iframe
    const iframe = document.getElementById('dynamic-iframe');
    iframe.src = appsScriptUrl;

    // Request fullscreen
    iframe.requestFullscreen().catch((err) => {
        console.error(`Error attempting to enable full-screen mode: ${err.message}`);
    });
};
</script>
</body>
</html>
